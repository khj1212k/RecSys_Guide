[< ìƒìœ„ í´ë”ë¡œ ì´ë™](README.md)

<details>
<summary><strong>ì „ì²´ íƒìƒ‰ (RecSys ê°€ì´ë“œ)</strong></summary>

- [í™ˆ](../../README.md)
- [01. ì „í†µì  ëª¨ë¸](../../01_Traditional_Models/README.md)
  - [í˜‘ì—… í•„í„°ë§](../../01_Traditional_Models/01_Collaborative_Filtering/README.md)
    - [ë©”ëª¨ë¦¬ ê¸°ë°˜](../../01_Traditional_Models/01_Collaborative_Filtering/01_Memory_Based/README.md)
    - [ëª¨ë¸ ê¸°ë°˜](../../01_Traditional_Models/01_Collaborative_Filtering/02_Model_Based/README.md)
  - [ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§](../../01_Traditional_Models/02_Content_Based_Filtering/README.md)
- [02. ê³¼ë„ê¸° ë° í†µê³„ì  ëª¨ë¸](../../02_Machine_Learning_Era/README.md)
- [03. ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸](../../03_Deep_Learning_Era/README.md)
  - [MLP ê¸°ë°˜](../../03_Deep_Learning_Era/01_MLP_Based/README.md)
  - [ìˆœì°¨/ì„¸ì…˜ ê¸°ë°˜](../../03_Deep_Learning_Era/02_Sequence_Session_Based/README.md)
  - [ê·¸ë˜í”„ ê¸°ë°˜](../../03_Deep_Learning_Era/03_Graph_Based/README.md)
  - [ì˜¤í† ì¸ì½”ë” ê¸°ë°˜](../../03_Deep_Learning_Era/04_AutoEncoder_Based/README.md)
- [04. ìµœì‹  ë° ìƒì„±í˜• ëª¨ë¸](../../04_SOTA_GenAI/README.md) - [LLM ê¸°ë°˜](../../04_SOTA_GenAI/01_LLM_Based/README.md) - [ë©€í‹°ëª¨ë‹¬ ì¶”ì²œ](../../04_SOTA_GenAI/02_Multimodal_RS.md) - [ìƒì„±í˜• ì¶”ì²œ](../../04_SOTA_GenAI/03_Generative_RS.md)
</details>

# ìš”ì¸í™” ê¸°ê³„ (Factorization Machines, FM)

## 1. ìƒì„¸ ì„¤ëª… (Detailed Description)

### ì •ì˜ (Definition)

**Factorization Machines (FM)**ì€ 2010ë…„ Steffen Rendleì´ ì œì•ˆí•œ ë²”ìš© ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ (SVM)ì˜ ì¥ì ê³¼ ìš”ì¸í™” ëª¨ë¸(Factorization Models)ì˜ ì¥ì ì„ ê²°í•©í–ˆìŠµë‹ˆë‹¤. í–‰ë ¬ ë¶„í•´(MF)ì™€ ìœ ì‚¬í•˜ì§€ë§Œ, ì‹¤ìˆ˜(Real-valued) íŠ¹ì§• ë²¡í„°ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆì–´ "ë³´ì¡° ì •ë³´"(ë§¥ë½, ì‹œê°„, ë‹¤ì–‘í•œ ì‚¬ìš©ì ì†ì„±)ë¥¼ í†µí•©í•˜ëŠ” ë° ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ (The Problem it Solves)

- **SVM**: í¬ì†Œ ë°ì´í„°ì—ì„œ ì‹¤íŒ¨í•©ë‹ˆë‹¤. íŠ¹ì§• $x_i$ì™€ $x_j$ì˜ ìƒí˜¸ì‘ìš© ê°€ì¤‘ì¹˜ $w_{ij}$ë¥¼ ì§ì ‘ í•™ìŠµí•˜ë ¤ $w_{ij} x_i x_j$ í•­ì„ ì‚¬ìš©í•˜ëŠ”ë°, í•™ìŠµ ë°ì´í„°ì— $x_i$ì™€ $x_j$ê°€ ë™ì‹œì— ë“±ì¥í•œ ì ì´ ì—†ìœ¼ë©´ $w_{ij}$ëŠ” 0ì´ ë˜ì–´ë²„ë¦½ë‹ˆë‹¤.
- **MF**: ì‚¬ìš©ìì™€ ì•„ì´í…œ IDë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **FM**: ìƒí˜¸ì‘ìš© ê°€ì¤‘ì¹˜ $w_{ij}$ë¥¼ ë‘ ë²¡í„°ì˜ ë‚´ì  $\langle v_i, v_j \rangle$ë¡œ ëª¨ë¸ë§í•˜ì—¬ í¬ì†Œì„± ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤. $x_i$ì™€ $x_j$ê°€ ê°™ì´ ë“±ì¥í•œ ì ì´ ì—†ë”ë¼ë„, $x_i$ê°€ $x_k$ì™€ í•¨ê»˜, $x_j$ê°€ $x_k$ì™€ í•¨ê»˜ ë“±ì¥í–ˆë‹¤ë©´, $v_i$ì™€ $v_j$ê°€ í•™ìŠµë˜ì–´ $i-j$ ìƒí˜¸ì‘ìš©ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§• (Key Characteristics)

- **ë²”ìš©ì„±**: íšŒê·€(Regression), ë¶„ë¥˜(Classification), ë­í‚¹(Ranking) ëª¨ë‘ì— ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
- **ì†ë„**: í•™ìŠµ ë° ì˜ˆì¸¡ ì‹œê°„ì´ ì„ í˜•ì ì…ë‹ˆë‹¤ ($O(k \cdot n)$).
- **ì¥ì **:
  - ê·¹ë„í¬ í¬ì†Œí•œ ë°ì´í„°(Extreme Sparsity)ë¥¼ ì˜ ë‹¤ë£¹ë‹ˆë‹¤.
  - ì–´ë–¤ ë³´ì¡° íŠ¹ì§•(Context-aware)ì´ë“  ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë‹¨ì **:
  - ì ì¬ ì°¨ì› $k$ë¥¼ ë¯¸ë¦¬ ì •í•´ì•¼ í•©ë‹ˆë‹¤.

---

## 2. ì‘ë™ ì›ë¦¬ (Operating Principle)

### ëª¨ë¸ ìˆ˜ì‹ (Degree = 2)

íŠ¹ì§• ë²¡í„° $x \in \mathbb{R}^n$ì— ëŒ€í•´, ì˜ˆì¸¡ê°’ $\hat{y}$ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

$$ \hat{y}(x) = w*0 + \sum*{i=1}^n w*i x_i + \sum*{i=1}^n \sum\_{j=i+1}^n \langle v_i, v_j \rangle x_i x_j $$

- **ê¸€ë¡œë²Œ í¸í–¥ ($w_0$)**: ì „ì²´ í‰ê·  ë² ì´ìŠ¤ë¼ì¸.
- **ì„ í˜• í•­ ($\sum w_i x_i$)**: ê° íŠ¹ì§•ì˜ ë…ë¦½ì ì¸ ì˜í–¥ (ì˜ˆ: "ì´ ì‚¬ìš©ìëŠ” ì ìˆ˜ë¥¼ í›„í•˜ê²Œ ì£¼ëŠ” í¸ì´ë‹¤").
- **ìƒí˜¸ì‘ìš© í•­ ($\sum \langle v_i, v_j \rangle x_i x_j$)**: ìŒ(Pairwise) ìƒí˜¸ì‘ìš©.
  - ê±°ëŒ€í•œ $n \times n$ í–‰ë ¬ $W$ ëŒ€ì‹ , $n \times k$ í–‰ë ¬ $V$ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
  - $\langle v_i, v_j \rangle$ê°€ $w_{ij}$ë¥¼ ëŒ€ì²´í•©ë‹ˆë‹¤.

### ìµœì í™” (Optimization)

- **SGD**, **ALS**, **MCMC** ë“±ì„ ì‚¬ìš©í•˜ì—¬ ìµœì í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìƒí˜¸ì‘ìš© í•­ì€ ë‹¤ìŒì˜ ìˆ˜ì‹ì„ ì´ìš©í•´ $O(kn)$ ì„ í˜• ì‹œê°„ ë‚´ì— ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
  $$ \sum*{i=1}^n \sum*{j=i+1}^n \langle v*i, v_j \rangle x_i x_j = \frac{1}{2} \sum*{f=1}^k \left( \left( \sum*{i=1}^n v*{i,f} x*i \right)^2 - \sum*{i=1}^n v\_{i,f}^2 x_i^2 \right) $$

---

## 3. íë¦„ ì˜ˆì‹œ (Flow Example)

### ì‹œë‚˜ë¦¬ì˜¤: ë§¥ë½ì„ ê³ ë ¤í•œ ì˜í™” í‰ì 

ë°ì´í„°: **User=Alice**, **Movie=Titanic**, **Time=Weekend**.
ì…ë ¥ ë²¡í„° (One-hot):
$x = [\underbrace{1}_{\text{Alice}}, 0, ..., \underbrace{1}_{\text{Titanic}}, 0, ..., \underbrace{1}_{\text{Weekend}}]$

### ê³„ì‚° ê³¼ì •

1.  **ì„ í˜• ë¶€ë¶„ (Linear Part)**:
    $w_{Alice} + w_{Titanic} + w_{Weekend}$
    (ì˜ˆ: AliceëŠ” ê´€ëŒ€í•¨ +0.2, Titanicì€ ì¸ê¸°ì‘ +0.5, ì£¼ë§ì—” ê¸°ë¶„ ì¢‹ìŒ +0.1).

2.  **ìƒí˜¸ì‘ìš© ë¶€ë¶„ (Interaction Part)**:

    - **Alice-Titanic**: $\langle v_{Alice}, v_{Titanic} \rangle$. Aliceê°€ ì´ëŸ° *ìœ í˜•*ì˜ ì˜í™”ë¥¼ ì¢‹ì•„í•˜ëŠ”ê°€?
    - **Alice-Weekend**: $\langle v_{Alice}, v_{Weekend} \rangle$. AliceëŠ” ì£¼ë§ì— ì˜í™”ë¥¼ ìì£¼ ë³´ëŠ”ê°€?
    - **Titanic-Weekend**: $\langle v_{Titanic}, v_{Weekend} \rangle$. Titanicì€ ì£¼ë§ìš© ì˜í™”ì¸ê°€?

3.  **í•©ê³„ (Sum)**:
    ì´ì  = ì„ í˜• í•© + ìƒí˜¸ì‘ìš© í•©.
    ë§Œì•½ Aliceê°€ Titanicì„ ì¢‹ì•„í•˜ê³ (ë†’ì€ ìƒí˜¸ì‘ìš©), ì£¼ë§ì— ì˜í™” ë³´ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤ë©´(ë†’ì€ ìƒí˜¸ì‘ìš©), ì ìˆ˜ëŠ” ë§¤ìš° ë†’ì•„ì§‘ë‹ˆë‹¤.

### ì‹œê°ì  ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph TD
    subgraph "Factorization Machine Structure"
        direction TB

        %% Input Layer
        Input["ğŸ“¥ ì…ë ¥ ë²¡í„° x (One-Hot Encoded) <br> [Alice, ... Titanic, ... Weekend]"]

        %% Weights
        subgraph "Weights (Parameters)"
            W0["wâ‚€ (Global Bias)"]
            Wi["wáµ¢ (1ì°¨ ê°€ì¤‘ì¹˜)"]
            V["V (2ì°¨ ì ì¬ í–‰ë ¬)"]
        end

        %% Operations
        Input --> |"xáµ¢=1"| LinearTerm["1ï¸âƒ£ ì„ í˜• í•­ ê³„ì‚°<br>âˆ‘ wáµ¢xáµ¢"]
        Wi -.-> LinearTerm

        Input --> |"Non-zero Indices"| EmbedLookup["ğŸ”‘ ì„ë² ë”© ì¡°íšŒ (Embedding Lookup)<br>v_Alice, v_Titanic, v_Weekend"]
        V -.-> EmbedLookup

        %% Interaction
        EmbedLookup --> Interactions["2ï¸âƒ£ ìƒí˜¸ì‘ìš© í•­ ê³„ì‚°<br>Pairwise Dot Product <váµ¢, vâ±¼>"]

        interactions_list(("<v_Alice, v_Titanic><br><v_Alice, v_Weekend><br><v_Titanic, v_Weekend>"))
        Interactions --- interactions_list

        %% Aggregation
        W0 --> FinalSum
        LinearTerm --> FinalSum["â• ìµœì¢… í•©ì‚° (Summation)<br>wâ‚€ + Linear + Interactions"]
        interactions_list --> FinalSum

        %% Output
        FinalSum --> Output["ğŸ“¤ ì˜ˆì¸¡ ê²°ê³¼ Å·"]
    end

    %% Styling
    style Input fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style LinearTerm fill:#fff9c4,stroke:#fbc02d
    style Interactions fill:#e1bee7,stroke:#8e24aa
    style interactions_list fill:#f3e5f5,stroke:#ab47bc,stroke-dasharray: 5 5
    style Output fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
```
